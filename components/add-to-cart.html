<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
    <style>
        .cart {
            position: relative;
        }

        .cart-count {
            position: absolute;
            padding: 3px 7px;
            background-color: red;
            border-radius: 50%;
        }
    </style>
</head>

<body>
    <div class="cart">
        <a href="cart.html"><i class="ri-shopping-cart-fill" title="Cart"></i></a>
        <span class="cart-count">0</span>
    </div>

    <div class="product-card">
        <img src="images/1.png" alt="Product" width="100px">
        <div class="product-name">Nike shoes</div>
        <div class="product-price"><del>$50.00</del></div>
        <div class="product-sale-price">$45.00</div>
        <button class="add-to-cart">Add to cart</button>

    </div>

    <div class="product-card">
        <img src="images/2.png" alt="Product" width="100px">
        <div class="product-name">Nike shoes blue</div>
        <div class="product-price">$55.00</div>
        <button class="add-to-cart">Add to cart</button>

    </div>

    <script>
        // document.addEventListener("DOMContentLoaded", () => {
        //     let cartCount = 0; 
        //     const cartCountDisplay = document.querySelector(".cart-count");
        //     const addToCartButtons = document.querySelectorAll(".add-to-cart");

        //     const updateCartCount = () => {
        //         cartCountDisplay.textContent = cartCount;
        //         cartCountDisplay.style.display = cartCount > 0 ? "inline-block" : "none"; 
        //     };

        //     addToCartButtons.forEach(button => {
        //         button.addEventListener("click", () => {
        //             cartCount++; 
        //             updateCartCount();
        //         });
        //     });

        //     updateCartCount(); 
        // });

        document.addEventListener("DOMContentLoaded", () => {
            let cartCount = localStorage.getItem("cartCount") ? parseInt(localStorage.getItem("cartCount")) : 0;
            let cartItems = localStorage.getItem("cartItems") ? JSON.parse(localStorage.getItem("cartItems")) : [];

            const cartCountDisplay = document.querySelector(".cart-count");
            const addToCartButtons = document.querySelectorAll(".add-to-cart");

            // Function to update cart count display
            const updateCartCount = () => {
                let totalItems = cartItems.reduce((total, item) => total + item.quantity, 0); // Sum all item quantities
                cartCountDisplay.textContent = totalItems;
                cartCountDisplay.style.display = totalItems > 0 ? "inline-block" : "none";

                // Save cart count and items to localStorage
                localStorage.setItem("cartCount", totalItems);
                localStorage.setItem("cartItems", JSON.stringify(cartItems));
            };

            // Loop through all "Add to cart" buttons
            addToCartButtons.forEach(button => {
                button.addEventListener("click", (event) => {
                    const productCard = event.target.closest(".product-card");
                    const productName = productCard.querySelector(".product-name").textContent;
                    const productPrice = productCard.querySelector(".product-sale-price")
                        ? productCard.querySelector(".product-sale-price").textContent
                        : productCard.querySelector(".product-price").textContent;
                    const productImage = productCard.querySelector("img").src;
                    const quantityInput = productCard.querySelector(".quantity"); // Get the quantity field

                    let quantity = quantityInput ? parseInt(quantityInput.textContent) : 1; // Default to 1 if no quantity selector

                    // Check if product already exists in the cart
                    let existingProduct = cartItems.find(item => item.name === productName);

                    if (existingProduct) {
                        existingProduct.quantity += quantity; // Increase quantity if exists
                    } else {
                        // Create product object
                        const product = { name: productName, price: productPrice, image: productImage, quantity };
                        cartItems.push(product);
                    }

                    updateCartCount(); // Update UI
                });
            });

            updateCartCount(); // Initialize UI on page load
        });


    </script>
</body>

</html>